# character set on messages that we send
set send_charset="utf-8"
# if there is no character set given on incoming messages, it is probably windows
set assumed_charset="iso-8859-1"
# just scroll one line instead of full page
set menu_scroll=yes

#set mail_check = 0
set mail_check=60       # check for new mail every 90 seconds
set timeout=15           # after 15 secs of no keypresses, start checking for new mail
unset move
set delete
unset confirmappend
unset mark_old
# do not ask to recall postponed messages
set recall=no

# save outgoing email
set copy=yes

# enable sidebar
set sidebar_visible=yes
set sidebar_width=30

# beep on new mail
set beep_new

set implicit_autoview
# we want to see some MIME types inline, see below this code listing for explanation
auto_view application/msword
auto_view application/pdf
auto_view application/html
auto_view image/gif
auto_view text/html
auto_view image/jpg
alternative_order text/html text/plain *

# make default search pattern to search in To, Cc and Subject
set simple_search="~f %s | ~C %s | ~s %s"

# threading preferences, sort by threads
set sort=threads
set sort_aux = reverse-last-date-received
set sort_re # thread based on reply_regexp
set strict_threads=yes

# pager in mail view format
set pager_format = " %C - %D from %.20n. Subj: %s%* %?H? [%H] ?"
# list view format
set index_format = "%4C %Z %{%b %d %Y} %-25.25L (%4c) %s"

# don't split words
set smart_wrap
# show tildes like in vim
set tilde
# no ugly plus signs
unset markers

set edit_headers=yes      # See the headers when editing

# mailbox configuraton
set mbox_type   = Maildir
set folder      = "~/.mail"
set spoolfile   = "+INBOX"
#set mbox        = "+sent"
set postponed   = "+drafts"
set record 		= "+sent"
#unset record                            # required to prevent duplicates in Sent


# mailboxes
mailboxes +INBOX +sent +drafts

# bindings
macro index D "<save-message>+trash<enter>"   "move message to the trash"
macro index S "<save-message>+spam<enter>"    "mark message as spam"

# composing mail
# save attachments with the body
set fcc_attach
set forward_format = "Fwd: %s"
# include message in replies
set include
# include message in forwards
set forward_quote
set mime_forward=yes
set mime_forward_rest=yes

# personality settings
set realname = "yourname"
set from = "yourmail"

#stuff to compose multipart/mixed mail for the corporate sigmanute shitty thing
set editor=email-editor
macro compose B ":set editor=text2mime-markdown.pl<enter>E:set editor=email-editor<enter>a/tmp/html-markdown-alternative.html<enter>^Dua/home/jpoly/.signature/image001.jpg<enter>^D<Home>D"
#send-hook . 'push B'
set sendmail="/usr/bin/msmtp"


#---- Mutt Colors for Black Background -------
color   hdrdefault   blue              black
color   quoted       blue              black
color   signature    blue              black
color   attachment   red               black
color   message      brightred         black
color   error        brightred         black
color   indicator    black             red
color   status       brightgreen       blue
color   tree         white             black
color   normal       white             black
color   markers      red               black
color   search       white             black
color   tilde        brightmagenta     black
color   index        blue              black ~F
color   index        red               black "~N|~O"
# if you don't like the black progress bar at the bottom of the screen,
# comment out the following line
color progress    white          black

# Section for PGP signing
set crypt_autopgp=no # disabe PGP...
set crypt_autosmime=yes # use SMIME instead
set crypt_verify_sig=yes
set smime_is_default=yes
set crypt_autosign=yes
set smime_keys="~/.smime/keys"
set smime_certificates="~/.smime/certificates"
set smime_ca_location="~/.smime/ca-bundle.crt"
set smime_default_key="9b1df715.0"
#set smime_sign_as="9b1df715.0"
#set smime_sign_command="openssl smime -sign -signer %c -inkey %k -passin stdin -in %f -certfile %i -outform DER"
set smime_sign_command="mutt-smime-sign.pl %f"
# These are used to extract a certificate from a message.
# First generate a PKCS#7 structure from the message.
set smime_pk7out_command="openssl smime -verify -in %f -noverify -pk7out"

# Extract the included certificate(s) from a PKCS#7 structure.
set smime_get_cert_command="openssl pkcs7 -print_certs -in %f"

# Extract the signer's certificate only from a S/MIME signature (sender verification)
set smime_get_signer_cert_command="openssl smime -verify -in %f -noverify -signer %c -out /dev/null"
# Extract the included certificate(s) from a PKCS#7 structure.
set smime_get_cert_command="openssl pkcs7 -print_certs -in %f"
# This is used to get the email address the certificate was issued to.
set smime_get_cert_email_command="openssl x509 -in  %f -noout -email"
# Add a certificate to the database using smime_keys.
set smime_import_cert_command="smime_keys add_cert %f"
# Verify a signature of type multipart/signed
set smime_verify_command="openssl smime -verify -inform DER -in %s -CAfile /home/jpoly/.smime/IntralotOfficialCA.cer -content %f"
# Verify a signature of type application/x-pkcs7-mime
set smime_verify_opaque_command="openssl smime -verify -inform DER -in %s -CAfile /home/jpoly/.smime/IntralotOfficialCA.cer"
#set pgp_sign_as="0xBD113717"
#set pgp_timeout=1200
#set pgp_autoinline=yes
#set pgp_show_unusable=yes
#set pgp_auto_decode=yes

# Navigation key bindings
bind pager /           search
bind pager <up>        previous-line
bind pager <down>      next-line
bind pager gg          top
bind pager G           bottom
bind index gg          first-entry
bind index G           last-entry
bind pager N           previous-undeleted
bind pager n           next-undeleted
bind index n           previous-unread
bind index N           next-unread
bind index,pager R     group-reply

# macros
macro index B   "<limit>~b "                "search message bodies"
macro index I   "<change-folder>!<enter>"   "go to Inbox"

# quick-sync ~/Mail immediately with offlineimap
macro index Z   "<shell-escape>/usr/bin/offlineimap -q -o<enter>" "sync IMAP"

# abbok stuff
set query_command = "abook --mutt-query '%s'"
bind editor <Tab> complete-query
